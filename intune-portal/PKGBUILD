# Maintainer: Recolic K <root@recolic.net>

pkgname=intune-portal
pkgver=1.2511.7
pkgrel=0
pkgdesc="Microsoft Intune helps organizations manage access to corporate apps, data, and resources."
url="https://packages.microsoft.com/ubuntu/24.04/prod/pool/main/i/intune-portal"
license=("GPL2")
arch=("x86_64")
# Official Depends: libwebkit2gtk-4.1-0 (>= 2.39.90), libuuid1 (>= 2.16), libssl3t64 (>= 3.0.0), libcurl4t64 (>= 7.16.2), libgtk-3-0t64 (>= 3.13.7), libsystemd0, libpam0g (>= 0.99.7.1), libpam-pwquality (>= 1.4.0-2), microsoft-identity-broker (>= 2.0.2), libsoup-3.0-0 (>= 2.4.0), libp11-kit0 (>= 0.25.0), zlib1g (>= 1:1.2.0), libc6 (>= 2.38), libsqlite3-0 (>= 3.7.14), libsecret-1-0 (>= 0.7), libdbus-1-3 (>= 1.9.14), libglib2.0-0t64 (>= 2.70.0), libc6 (>= 2.34), libatk1.0-0t64 (>= 1.12.4), libgtk-3-0t64 (>= 3.21.4), libstdc++6 (>= 13), libx11-6, libpango-1.0-0 (>= 1.14.0), gnome-keyring (>= 3.36)
depends=("microsoft-identity-broker>2.0.2" "webkit2gtk" "gnome-keyring" "libsecret" "openssl")
makedepends=()
conflicts=()
replaces=()
backup=()
source=("source.deb::$url/${pkgname}_${pkgver}-noble_amd64.deb")
sha256sums=("307bc09a47a6c76f1935c565a05371274dd86f1ae054fbc1ece38c611e8eca8f")
install=x.install

package() {
  cd "$srcdir"
  ar x source.deb
  tar xvJf data.tar.xz

  mkdir -p usr/bin
  [ ! -f usr/bin/intune-portal ] && ln -s ../../opt/microsoft/intune/bin/intune-portal usr/bin/intune-portal
  cp -r "$srcdir/usr" "$srcdir/opt" "$pkgdir/"
  cp -r "$srcdir/lib" "$pkgdir/usr/"
}
